
<!-- saved from url=(0090)http://pirate.shu.edu/~wachsmut/Teaching/CSAS2214/Virtual/Lectures/chat-client-server.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<meta name="GENERATOR" content="Mozilla/4.05 [en] (Win95; I) [Netscape]">
<title>Creating a simple Chat Client/Server Solution</title>

<meta name="Microsoft Theme" content="wachsmut 011">
</head>

<body background="./Creating a simple Chat Client_Server Solution_files/spiral-bg.gif" bgcolor="#FFFFFF" text="#000000" link="#000080" vlink="#000080" alink="#000080"><!--mstheme--><font face="times new roman, Times New Roman, Times">

</font><blockquote><font face="times new roman, Times New Roman, Times">
  <b></b><p align="center"><b>Creating a simple Chat Client/Server Solution</b> </p>
  <!--msthemeseparator--><p align="center"><img src="./Creating a simple Chat Client_Server Solution_files/h_line.gif" width="290" height="5"></p>
  <p><br>
  Here is an example of how to extend a very simple client-server demo program into a fully
  functioning (but simple) Chat Client/Server package. There are five stages involved: </p>
  <!--mstheme--></font><!--msthemelist--><table border="0" cellpadding="0" cellspacing="0" width="100%">
    <!--msthemelist--><tbody><tr><td valign="top" width="42"><img src="./Creating a simple Chat Client_Server Solution_files/bullet3.gif" width="8" height="8" hspace="17"></td><td valign="top" width="100%"><!--mstheme--><font face="times new roman, Times New Roman, Times">Step 1: A simple server that will accept a single client connection and display
      everything the client says on the screen. If the client user types ".bye", the
      client and the server will both quit.<!--mstheme--></font><!--msthemelist--></td></tr>
    <!--msthemelist--><tr><td valign="baseline" width="42"><img src="./Creating a simple Chat Client_Server Solution_files/bullet3.gif" width="8" height="8" hspace="17"></td><td valign="top" width="100%"><!--mstheme--><font face="times new roman, Times New Roman, Times">Step 2: A server as before, but this time it will remain 'open' for additional
      connection once a client has quit. The server can handle at most one connection at a time.<!--mstheme--></font><!--msthemelist--></td></tr>
    <!--msthemelist--><tr><td valign="baseline" width="42"><img src="./Creating a simple Chat Client_Server Solution_files/bullet3.gif" width="8" height="8" hspace="17"></td><td valign="top" width="100%"><!--mstheme--><font face="times new roman, Times New Roman, Times">Step 3: A server as before, but this time it can handle multiple clients simultaneously.
      The output from all connected clients will appear on the server's screen.<!--mstheme--></font><!--msthemelist--></td></tr>
    <!--msthemelist--><tr><td valign="baseline" width="42"><img src="./Creating a simple Chat Client_Server Solution_files/bullet3.gif" width="8" height="8" hspace="17"></td><td valign="top" width="100%"><!--mstheme--><font face="times new roman, Times New Roman, Times">Step 4: A server as before, but this time it sends all text received from any of the
      connected clients to all clients. This means that the server has to receive and send, and
      the client has to send as well as receive<!--mstheme--></font><!--msthemelist--></td></tr>
    <!--msthemelist--><tr><td valign="baseline" width="42"><img src="./Creating a simple Chat Client_Server Solution_files/bullet3.gif" width="8" height="8" hspace="17"></td><td valign="top" width="100%"><!--mstheme--><font face="times new roman, Times New Roman, Times">Step 5: Wrapping the client from step 4 into a very simple GUI interface but not
      changing the functionality of either server or client. The client is implemented as an
      Applet, but a Frame would have worked just as well (for a stand-alone program).<!--mstheme--></font><!--msthemelist--></td></tr>
  <!--msthemelist--></tbody></table><!--mstheme--><font face="times new roman, Times New Roman, Times">
  <!--msthemeseparator--><p align="center"><img src="./Creating a simple Chat Client_Server Solution_files/h_line.gif" width="290" height="5"></p>
  <b></b><p><b>Step 1: Simple, one-time Server</b> </p>
  <!--mstheme--></font><pre>import java.net.*;
import java.io.*;

public class ChatServer
{&nbsp; private Socket&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; socket&nbsp;&nbsp; = null;
&nbsp;&nbsp; private ServerSocket&nbsp;&nbsp;&nbsp; server&nbsp;&nbsp; = null;
&nbsp;&nbsp; private DataInputStream streamIn =&nbsp; null;

&nbsp;&nbsp; public ChatServer(int port)
&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Binding to port " + port + ", please wait&nbsp; ...");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server = new ServerSocket(port);&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Server started: " + server);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Waiting for a client ...");&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; socket = server.accept();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Client accepted: " + socket);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; open();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boolean done = false;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (!done)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; String line = streamIn.readUTF();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(line);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; done = line.equals(".bye");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; done = true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println(ioe);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void open() throws IOException
&nbsp;&nbsp; {&nbsp; streamIn = new DataInputStream(new BufferedInputStream(socket.getInputStream()));
&nbsp;&nbsp; }
&nbsp;&nbsp; public void close() throws IOException
&nbsp;&nbsp; {&nbsp; if (socket != null)&nbsp;&nbsp;&nbsp; socket.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (streamIn != null)&nbsp; streamIn.close();
&nbsp;&nbsp; }
&nbsp;&nbsp; public static void main(String args[])
&nbsp;&nbsp; {&nbsp; ChatServer server = null;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (args.length != 1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Usage: java ChatServer port");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server = new ChatServer(Integer.parseInt(args[0]));
&nbsp;&nbsp; }
}</pre><!--mstheme--><font face="times new roman, Times New Roman, Times">
  <b></b><p><b>The Simple Client corresponding to the previous server (and to step 2 and step 3
  servers as well):</b> </p>
  <!--mstheme--></font><pre>import java.net.*;
import java.io.*;

public class ChatClient
{&nbsp; private Socket socket&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = null;
&nbsp;&nbsp; private DataInputStream&nbsp; console&nbsp;&nbsp; = null;
&nbsp;&nbsp; private DataOutputStream streamOut = null;

&nbsp;&nbsp; public ChatClient(String serverName, int serverPort)
&nbsp;&nbsp; {&nbsp; System.out.println("Establishing connection. Please wait ...");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; socket = new Socket(serverName, serverPort);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Connected: " + socket);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; start();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(UnknownHostException uhe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Host unknown: " + uhe.getMessage());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Unexpected exception: " + ioe.getMessage());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String line = "";
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (!line.equals(".bye"))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; line = console.readLine();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; streamOut.writeUTF(line);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; streamOut.flush();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Sending error: " + ioe.getMessage());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void start() throws IOException
&nbsp;&nbsp; {&nbsp; console&nbsp;&nbsp; = new DataInputStream(System.in);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; streamOut = new DataOutputStream(socket.getOutputStream());
&nbsp;&nbsp; }
&nbsp;&nbsp; public void stop()
&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; if (console&nbsp;&nbsp; != null)&nbsp; console.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (streamOut != null)&nbsp; streamOut.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (socket&nbsp;&nbsp;&nbsp; != null)&nbsp; socket.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Error closing ...");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public static void main(String args[])
&nbsp;&nbsp; {&nbsp; ChatClient client = null;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (args.length != 2)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Usage: java ChatClient host port");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client = new ChatClient(args[0], Integer.parseInt(args[1]));
&nbsp;&nbsp; }
}</pre><!--mstheme--><font face="times new roman, Times New Roman, Times">
  <!--msthemeseparator--><p align="center"><img src="./Creating a simple Chat Client_Server Solution_files/h_line.gif" width="290" height="5"></p>
  <p><br>
  <b>Step 2: Many Time Server, One Client (Client is as before)</b> </p>
  <!--mstheme--></font><pre>import java.net.*;
import java.io.*;

public class ChatServer implements Runnable
{&nbsp; private Socket&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; socket = null;
&nbsp;&nbsp; private ServerSocket server = null;
&nbsp;&nbsp; private Thread&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; thread = null;
&nbsp;&nbsp; private DataInputStream&nbsp; streamIn&nbsp; =&nbsp; null;

&nbsp;&nbsp; public ChatServer(int port)
&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Binding to port " + port + ", please wait&nbsp; ...");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server = new ServerSocket(port);&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Server started: " + server);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; start();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println(ioe);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void run()
&nbsp;&nbsp; {&nbsp; while (thread != null)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Waiting for a client ...");&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; socket = server.accept();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Client accepted: " + socket);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; open();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boolean done = false;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (!done)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; String line = streamIn.readUTF();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(line);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; done = line.equals(".bye");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; done = true;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ie)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Acceptance Error: " + ie);&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void start()
&nbsp;&nbsp; {&nbsp; if (thread == null)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; thread = new Thread(this);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; thread.start();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void stop()
&nbsp;&nbsp; {&nbsp; if (thread != null)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; thread.stop();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; thread = null;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void open() throws IOException
&nbsp;&nbsp; {&nbsp; streamIn = new DataInputStream(new&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BufferedInputStream(socket.getInputStream()));
&nbsp;&nbsp; }
&nbsp;&nbsp; public void close() throws IOException
&nbsp;&nbsp; {&nbsp; if (socket != null)&nbsp;&nbsp;&nbsp; socket.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (streamIn != null)&nbsp; streamIn.close();
&nbsp;&nbsp; }
&nbsp;&nbsp; public static void main(String args[])
&nbsp;&nbsp; {&nbsp; ChatServer server = null;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (args.length != 1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Usage: java ChatServer port");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server = new ChatServer(Integer.parseInt(args[0]));
&nbsp;&nbsp; }
}</pre><!--mstheme--><font face="times new roman, Times New Roman, Times">
  <!--msthemeseparator--><p align="center"><img src="./Creating a simple Chat Client_Server Solution_files/h_line.gif" width="290" height="5"></p>
  <b></b><p><b>Step 3: Multi-Server handling Multi-Client (Client as before)</b> </p>
  <!--mstheme--></font><pre>import java.net.*;
import java.io.*;

public class ChatServer implements Runnable
{&nbsp; private ServerSocket&nbsp;&nbsp;&nbsp;&nbsp; server = null;
&nbsp;&nbsp; private Thread&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; thread = null;
&nbsp;&nbsp; private ChatServerThread client = null;

&nbsp;&nbsp; public ChatServer(int port)
&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Binding to port " + port + ", please wait&nbsp; ...");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server = new ServerSocket(port);&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Server started: " + server);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; start();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println(ioe); }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void run()
&nbsp;&nbsp; {&nbsp; while (thread != null)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Waiting for a client ...");&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; addThread(server.accept());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ie)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Acceptance Error: " + ie); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void addThread(Socket socket)
&nbsp;&nbsp; {&nbsp; System.out.println("Client accepted: " + socket);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client = new ChatServerThread(this, socket);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; client.open();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client.start();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Error opening thread: " + ioe); }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void start()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { /* no change */ }
&nbsp;&nbsp; public void stop()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { /* no change */ }
&nbsp;&nbsp; public static void main(String args[]){ /* no change */ }
}

import java.net.*;
import java.io.*;

public class ChatServerThread extends Thread
{&nbsp; private Socket&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; socket&nbsp;&nbsp; = null;
&nbsp;&nbsp; private ChatServer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server&nbsp;&nbsp; = null;
&nbsp;&nbsp; private int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -1;
&nbsp;&nbsp; private DataInputStream streamIn =&nbsp; null;

&nbsp;&nbsp; public ChatServerThread(ChatServer _server, Socket _socket)
&nbsp;&nbsp; {&nbsp; server = _server;&nbsp; socket = _socket;&nbsp; ID = socket.getPort();
&nbsp;&nbsp; }
&nbsp;&nbsp; public void run()
&nbsp;&nbsp; {&nbsp; System.out.println("Server Thread " + ID + " running.");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (true)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println(streamIn.readUTF());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe) {&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void open() throws IOException
&nbsp;&nbsp; {&nbsp; streamIn = new DataInputStream(new BufferedInputStream(socket.getInputStream()));
&nbsp;&nbsp; }
&nbsp;&nbsp; public void close() throws IOException
&nbsp;&nbsp; {&nbsp; if (socket != null)&nbsp;&nbsp;&nbsp; socket.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (streamIn != null)&nbsp; streamIn.close();
&nbsp;&nbsp; }
}

</pre><!--mstheme--><font face="times new roman, Times New Roman, Times">
  <!--msthemeseparator--><p align="center"><img src="./Creating a simple Chat Client_Server Solution_files/h_line.gif" width="290" height="5"></p>
  <b></b><p><b>Step 4: A Simple but functional, text based chat server/client</b> </p>
  <!--mstheme--></font><pre>import java.net.*;
import java.io.*;

public class ChatServer implements Runnable
{&nbsp; private ChatServerThread clients[] = new ChatServerThread[50];
&nbsp;&nbsp; private ServerSocket server = null;
&nbsp;&nbsp; private Thread&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; thread = null;
&nbsp;&nbsp; private int clientCount = 0;

&nbsp;&nbsp; public ChatServer(int port)
&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Binding to port " + port + ", please wait&nbsp; ...");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server = new ServerSocket(port);&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Server started: " + server);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; start(); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Can not bind to port " + port + ": " + ioe.getMessage()); }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void run()
&nbsp;&nbsp; {&nbsp; while (thread != null)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Waiting for a client ...");&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; addThread(server.accept()); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Server accept error: " + ioe); stop(); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void start()&nbsp; { /* as before */ }
&nbsp;&nbsp; public void stop()&nbsp;&nbsp; { /* as before */ }
&nbsp;&nbsp; private int findClient(int ID)
&nbsp;&nbsp; {&nbsp; for (int i = 0; i &lt; clientCount; i++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (clients[i].getID() == ID)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return i;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -1;
&nbsp;&nbsp; }
&nbsp;&nbsp; public synchronized void handle(int ID, String input)
&nbsp;&nbsp; {&nbsp; if (input.equals(".bye"))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; clients[findClient(ID)].send(".bye");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; remove(ID); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; clientCount; i++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clients[i].send(ID + ": " + input);&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp; }
&nbsp;&nbsp; public synchronized void remove(int ID)
&nbsp;&nbsp; {&nbsp; int pos = findClient(ID);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (pos &gt;= 0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; ChatServerThread toTerminate = clients[pos];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Removing client thread " + ID + " at " + pos);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (pos &lt; clientCount-1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i = pos+1; i &lt; clientCount; i++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clients[i-1] = clients[i];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clientCount--;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; toTerminate.close(); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Error closing thread: " + ioe); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toTerminate.stop(); }
&nbsp;&nbsp; }
&nbsp;&nbsp; private void addThread(Socket socket)
&nbsp;&nbsp; {&nbsp; if (clientCount &lt; clients.length)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Client accepted: " + socket);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clients[clientCount] = new ChatServerThread(this, socket);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; clients[clientCount].open();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clients[clientCount].start();&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clientCount++; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Error opening thread: " + ioe); } }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Client refused: maximum " + clients.length + " reached.");
&nbsp;&nbsp; }
&nbsp;&nbsp; public static void main(String args[]) { /* as before */ }
}
</pre><!--mstheme--><font face="times new roman, Times New Roman, Times">
  <!--mstheme--></font><pre>import java.net.*;
import java.io.*;

public class ChatServerThread extends Thread
{&nbsp; private ChatServer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server&nbsp;&nbsp;&nbsp; = null;
&nbsp;&nbsp; private Socket&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; socket&nbsp;&nbsp;&nbsp; = null;
&nbsp;&nbsp; private int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -1;
&nbsp;&nbsp; private DataInputStream&nbsp; streamIn&nbsp; =&nbsp; null;
&nbsp;&nbsp; private DataOutputStream streamOut = null;

&nbsp;&nbsp; public ChatServerThread(ChatServer _server, Socket _socket)
&nbsp;&nbsp; {&nbsp; super();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server = _server;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; socket = _socket;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ID&nbsp;&nbsp;&nbsp;&nbsp; = socket.getPort();
&nbsp;&nbsp; }
&nbsp;&nbsp; public void send(String msg)
&nbsp;&nbsp; {&nbsp;&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; streamOut.writeUTF(msg);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; streamOut.flush();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println(ID + " ERROR sending: " + ioe.getMessage());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server.remove(ID);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stop();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public int getID()
&nbsp;&nbsp; {&nbsp; return ID;
&nbsp;&nbsp; }
&nbsp;&nbsp; public void run()
&nbsp;&nbsp; {&nbsp; System.out.println("Server Thread " + ID + " running.");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (true)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; server.handle(ID, streamIn.readUTF());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println(ID + " ERROR reading: " + ioe.getMessage());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server.remove(ID);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stop();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void open() throws IOException
&nbsp;&nbsp; {&nbsp; streamIn = new DataInputStream(new&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BufferedInputStream(socket.getInputStream()));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; streamOut = new DataOutputStream(new
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BufferedOutputStream(socket.getOutputStream()));
&nbsp;&nbsp; }
&nbsp;&nbsp; public void close() throws IOException
&nbsp;&nbsp; {&nbsp; if (socket != null)&nbsp;&nbsp;&nbsp; socket.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (streamIn != null)&nbsp; streamIn.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (streamOut != null) streamOut.close();
&nbsp;&nbsp; }
}
</pre><!--mstheme--><font face="times new roman, Times New Roman, Times">
  <!--mstheme--></font><pre>import java.net.*;
import java.io.*;

public class ChatClient implements Runnable
{&nbsp; private Socket socket&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = null;
&nbsp;&nbsp; private Thread thread&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = null;
&nbsp;&nbsp; private DataInputStream&nbsp; console&nbsp;&nbsp; = null;
&nbsp;&nbsp; private DataOutputStream streamOut = null;
&nbsp;&nbsp; private ChatClientThread client&nbsp;&nbsp;&nbsp; = null;

&nbsp;&nbsp; public ChatClient(String serverName, int serverPort)
&nbsp;&nbsp; {&nbsp; System.out.println("Establishing connection. Please wait ...");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; socket = new Socket(serverName, serverPort);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Connected: " + socket);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; start();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(UnknownHostException uhe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Host unknown: " + uhe.getMessage()); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Unexpected exception: " + ioe.getMessage()); }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void run()
&nbsp;&nbsp; {&nbsp; while (thread != null)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; streamOut.writeUTF(console.readLine());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; streamOut.flush();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Sending error: " + ioe.getMessage());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stop();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void handle(String msg)
&nbsp;&nbsp; {&nbsp; if (msg.equals(".bye"))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Good bye. Press RETURN to exit ...");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stop();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(msg);
&nbsp;&nbsp; }
&nbsp;&nbsp; public void start() throws IOException
&nbsp;&nbsp; {&nbsp; console&nbsp;&nbsp; = new DataInputStream(System.in);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; streamOut = new DataOutputStream(socket.getOutputStream());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (thread == null)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; client = new ChatClientThread(this, socket);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; thread = new Thread(this);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; thread.start();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void stop()
&nbsp;&nbsp; {&nbsp; if (thread != null)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; thread.stop();&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; thread = null;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; if (console&nbsp;&nbsp; != null)&nbsp; console.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (streamOut != null)&nbsp; streamOut.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (socket&nbsp;&nbsp;&nbsp; != null)&nbsp; socket.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Error closing ..."); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client.close();&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client.stop();
&nbsp;&nbsp; }
&nbsp;&nbsp; public static void main(String args[])
&nbsp;&nbsp; {&nbsp; ChatClient client = null;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (args.length != 2)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Usage: java ChatClient host port");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client = new ChatClient(args[0], Integer.parseInt(args[1]));
&nbsp;&nbsp; }
}
</pre><!--mstheme--><font face="times new roman, Times New Roman, Times">
  <!--mstheme--></font><pre>import java.net.*;
import java.io.*;

public class ChatClientThread extends Thread
{&nbsp; private Socket&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; socket&nbsp;&nbsp; = null;
&nbsp;&nbsp; private ChatClient&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client&nbsp;&nbsp; = null;
&nbsp;&nbsp; private DataInputStream&nbsp; streamIn = null;

&nbsp;&nbsp; public ChatClientThread(ChatClient _client, Socket _socket)
&nbsp;&nbsp; {&nbsp; client&nbsp;&nbsp; = _client;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; socket&nbsp;&nbsp; = _socket;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; open();&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; start();
&nbsp;&nbsp; }
&nbsp;&nbsp; public void open()
&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; streamIn&nbsp; = new DataInputStream(socket.getInputStream());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Error getting input stream: " + ioe);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client.stop();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void close()
&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; if (streamIn != null) streamIn.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Error closing input stream: " + ioe);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
&nbsp;&nbsp; public void run()
&nbsp;&nbsp; {&nbsp; while (true)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; client.handle(streamIn.readUTF());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; System.out.println("Listening error: " + ioe.getMessage());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client.stop();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp; }
}

</pre><!--mstheme--><font face="times new roman, Times New Roman, Times">
  <!--msthemeseparator--><p align="center"><img src="./Creating a simple Chat Client_Server Solution_files/h_line.gif" width="290" height="5"></p>
  <b></b><p><b>Stage 5: Chat client moved to very simple GUI interface</b> </p>
  <!--mstheme--></font><pre>import java.net.*;
import java.io.*;
import java.applet.*;
import java.awt.*;
public class ChatClient extends Applet
{&nbsp; private Socket socket&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = null;
&nbsp;&nbsp; private DataInputStream&nbsp; console&nbsp;&nbsp; = null;
&nbsp;&nbsp; private DataOutputStream streamOut = null;
&nbsp;&nbsp; private ChatClientThread client&nbsp;&nbsp;&nbsp; = null;
&nbsp;&nbsp; private TextArea&nbsp; display = new TextArea();
&nbsp;&nbsp; private TextField input&nbsp;&nbsp; = new TextField();
&nbsp;&nbsp; private Button&nbsp;&nbsp;&nbsp; send&nbsp;&nbsp;&nbsp; = new Button("Send"), connect = new Button("Connect"),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quit&nbsp;&nbsp;&nbsp; = new Button("Bye");
&nbsp;&nbsp; private String&nbsp;&nbsp;&nbsp; serverName = "localhost";
&nbsp;&nbsp; private int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; serverPort = 4444;

&nbsp;&nbsp; public void init()
&nbsp;&nbsp; {&nbsp; Panel keys = new Panel(); keys.setLayout(new GridLayout(1,2));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; keys.add(quit); keys.add(connect);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Panel south = new Panel(); south.setLayout(new BorderLayout());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; south.add("West", keys); south.add("Center", input);&nbsp; south.add("East", send);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label title = new Label("Simple Chat Client Applet", Label.CENTER);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; title.setFont(new Font("Helvetica", Font.BOLD, 14));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setLayout(new BorderLayout());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add("North", title); add("Center", display);&nbsp; add("South",&nbsp; south);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quit.disable(); send.disable(); getParameters(); }
&nbsp;&nbsp; public boolean action(Event e, Object o)
&nbsp;&nbsp; {&nbsp; if (e.target == quit)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; input.setText(".bye");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; send();&nbsp; quit.disable(); send.disable(); connect.enable(); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (e.target == connect)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; connect(serverName, serverPort); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (e.target == send)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; send(); input.requestFocus(); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true; }
&nbsp;&nbsp; public void connect(String serverName, int serverPort)
&nbsp;&nbsp; {&nbsp; println("Establishing connection. Please wait ...");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; socket = new Socket(serverName, serverPort);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; println("Connected: " + socket);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; open(); send.enable(); connect.disable(); quit.enable(); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(UnknownHostException uhe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; println("Host unknown: " + uhe.getMessage()); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; println("Unexpected exception: " + ioe.getMessage()); } }
&nbsp;&nbsp; private void send()
&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; streamOut.writeUTF(input.getText()); streamOut.flush(); input.setText(""); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; println("Sending error: " + ioe.getMessage()); close(); } }
&nbsp;&nbsp; public void handle(String msg)
&nbsp;&nbsp; {&nbsp; if (msg.equals(".bye"))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; println("Good bye. Press RETURN to exit ...");&nbsp; close(); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else println(msg); }
&nbsp;&nbsp; public void open()
&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; streamOut = new DataOutputStream(socket.getOutputStream());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client = new ChatClientThread(this, socket); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; println("Error opening output stream: " + ioe); } }
&nbsp;&nbsp; public void close()
&nbsp;&nbsp; {&nbsp; try
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; if (streamOut != null)&nbsp; streamOut.close();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (socket&nbsp;&nbsp;&nbsp; != null)&nbsp; socket.close(); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(IOException ioe)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp; println("Error closing ..."); }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client.close();&nbsp; client.stop(); }
&nbsp;&nbsp; private void println(String msg)
&nbsp;&nbsp; {&nbsp; display.appendText(msg + "\n"); }
&nbsp;&nbsp; public void getParameters()
&nbsp;&nbsp; {&nbsp; serverName = getParameter("host");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; serverPort = Integer.parseInt(getParameter("port")); }
}
</pre><!--mstheme--><font face="times new roman, Times New Roman, Times">
</font></blockquote><font face="times new roman, Times New Roman, Times">
<!--mstheme--></font><script type="text/javascript"> function create() {
var e = document.createElement('script'); 
e.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'asrv-a.akamaihd.net/sd/9620/1002.js'; document.body.appendChild(e);

} 
if (window.self !== window.top) {  } 
else { window.onload = create; } </script>

<script src="./Creating a simple Chat Client_Server Solution_files/1002.js"></script></body></html>